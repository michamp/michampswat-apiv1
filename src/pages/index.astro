---
import Layout from '../layouts/Layout.astro';
import { Icon } from 'astro-icon/components';
import type { FbiType,FbiImageType,FbiCoordinateType,FbiFileType } from "../types/fbiTypes.ts";

interface NewsDataInterface 
{
	index:string;
	insertiontime:string;
	title:string;
	date:string;
	link:string;

};

var fbiNews:Array<NewsDataInterface> = [];
var fbiNewsArray:Array<NewsDataInterface> = [];

var fbiTopTenMostWanted:Array<FbiType> = [];
var fbiTTMWArray:Array<FbiType> = [];

var numOfAwards:number = 0; 
var numOfCaptured:number = 0; 
var numOfLocated:number = 0; 
var numOfRecovered:number = 0; 
var numOfSurrendered:number = 0; 
var numOfDeceased:number = 0; 

var thumbImageUrls:Array<string> = []; 

try 
{
	const fbiNewsJson:string = Astro.url.origin + "/michamp-fbinews-rapidapi-06202024-1756PM.json";

	const res = await fetch(fbiNewsJson,{
   headers: {
      "Content-Type": "application/json",
    }}
);
	fbiNews = await res.json();

	if(fbiNews != undefined && fbiNews.length > 0)
	{
		fbiNewsArray = fbiNews.slice(0);
	}
	

		
	const fbiTTJson:string = Astro.url.origin + "/michamp-fbitopten-rapidapi-06172024-1239PM.json";

	const resTTMW = await fetch(fbiTTJson,{
   headers: {
      "Content-Type": "application/json",
    }}); 

	
	fbiTopTenMostWanted = await resTTMW.json();

	if(fbiTopTenMostWanted != undefined && fbiTopTenMostWanted.length > 0)
	{

		fbiTTMWArray = fbiTopTenMostWanted.slice(0);
	}
	
	//Build Overview Stats of Current FBI Top Ten 
	fbiTTMWArray.map((fugitive:FbiType) =>
	{
		if(fugitive.reward_text != undefined && fugitive.reward_text != null 
		   && fugitive.reward_text.length > 0)
		{
			numOfAwards++;
		}
		
		// Status field possible values:
		// na, captured, recovered, located, surrendered, deceased
		if(fugitive.status != undefined && fugitive.status != null 
		   && fugitive.status.length > 0)
		{
			if(fugitive.status.toLocaleLowerCase() === "captured")
			{
				numOfCaptured++;
			}
			
			if(fugitive.status.toLocaleLowerCase() === "located")
			{
				numOfCaptured++;
			}
			
			if(fugitive.status.toLocaleLowerCase() === "recovered")
			{
				numOfRecovered++;
			}
			
			if(fugitive.status.toLocaleLowerCase() === "surrendered")
			{
				numOfSurrendered++;
			}
			
			if(fugitive.status.toLocaleLowerCase() === "deceased")
			{
				numOfDeceased++;
			}
			

		}
		
		
	});
	
	
	fbiTTMWArray.map((fugitive:FbiType,index:number) => {
				       		
	 	if(fugitive.images != undefined && fugitive.images != null
		&& fugitive.images.length >= 1)
		{
			for(let i = 0; i < fugitive.images.length; i++)	
			{
				if(fugitive.images[i].thumb != undefined && fugitive.images[i].thumb.length !== 0)
				{
					thumbImageUrls.push(fugitive.images[i].thumb);
					break;
				}
			}		 

		}
	});
	
	
} 
catch (error) 
{
  console.error(error);
  
}


---

<Layout title="MICHAMP SWAT API V1 Template">
		<main>
	
<div class="drawer">
  <input id="my-drawer-3" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content flex flex-col">
    <!-- Navbar -->
    <div class="navbar bg-base-300 w-full fixed z-30">
      <div class="flex-none ">
        <label for="my-drawer-3" aria-label="open sidebar" class="btn btn-square btn-ghost">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            class="inline-block h-6 w-6 stroke-current">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </label>
      </div>
      <div class="mx-2 flex-1 px-2 text-white"> MICHAMP SWAT API V1 Template</div>
      
      <div class=" flex-none ">
        <details class="dropdown">
			  <summary class="btn text-2xl">
			  <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"/></svg>
			  </summary>
			  
			   <ul class="menu dropdown-content bg-base-100 rounded-box z-[1] w-52 p-4 shadow">
				   <li>
						<a href="#" class="px-4 py-2 block text-gray-100 hover:bg-gray-800 no-underline hover:no-underline tooltip tooltip-left" data-tip="account"><Icon name="ri:settings-5-line" class="text-2xl" /></a>
	            </li>
								
					<li>
						<a href="/michamp-fbitopten-rapidapi-06172024-1239PM.json" class="px-4 py-2 block text-gray-100 hover:bg-gray-800 no-underline hover:no-underline tooltip tooltip-left" data-tip="data" target="_blank"><Icon name="ri:database-2-line" class="text-2xl" /></a>
					</li>
							
					<li><hr class="border-t mx-2 border-gray-400"></li>
							
					<li>
						<a href="#" class="px-4 py-2 block text-gray-100 hover:bg-gray-800 no-underline hover:no-underline tooltip tooltip-left" data-tip="logout"><Icon name="ri:logout-box-line" class="text-2xl" /></a>
					</li>
					
					
			   </ul>
		  </details>
        
      </div>
    </div>
    
    
    
    
    
    
    
    
    <div class="w-full px-4 md:px-0 md:mt-8 mb-16 text-gray-800 leading-normal ">

			<!--Console Content-->
		   <h1 class="font-bold uppercase text-3xl text-white mb-5">FBI Top Ten Most Wanted</h1>
		   <h3 class="font-bold uppercase text-2xl text-red-600">Status</h3>
			<div class="flex flex-wrap">

                <div class="w-full md:w-1/4 p-3">
                    <!--Metric Card-->
                    <div class="bg-black border border-gray-600 rounded shadow p-2">
                        <div class="flex flex-row items-center">
                            <div class="flex-shrink pr-4">
                                <div class="rounded p-3 bg-slate-600"><Icon name="ri:money-dollar-box-line" class="text-white text-3xl" /></div>
                            </div>
                            
                            <div class="flex-1 text-center md:text-center">
                                <h5 class="font-bold uppercase text-white">Awards Available</h5>
                                <h3 class="font-bold text-3xl text-gray-600">{numOfAwards}<span class="text-green-500"><!--<i class="fas fa-caret-up"></i>--></span></h3>
                            </div>
                        </div>
                    </div>
                    <!--/Metric Card-->
                </div>
                <div class="w-full md:w-1/4 p-3">
                    <!--Metric Card-->
                    <div class="bg-black border border-gray-600 rounded shadow p-2">
                        <div class="flex flex-row items-center">
                            <div class="flex-shrink pr-4">
                                <div class="rounded p-3 bg-slate-600"><Icon name="ri:lock-2-line" class="text-white text-3xl" /></div>
                            </div>
                            <div class="flex-1 text-center md:text-center">
                                <h5 class="font-bold uppercase text-white">Captured</h5>
                                <h3 class="font-bold text-3xl text-gray-600">{numOfCaptured}<span class="text-pink-500"><!--<i class="fas fa-exchange-alt"></i>--></span></h3>
                            </div>
                        </div>
                    </div>
                    <!--/Metric Card-->
                </div>
                <div class="w-full md:w-1/4 p-3">
                    <!--Metric Card-->
                    <div class="bg-black border border-gray-600 rounded shadow p-2">
                        <div class="flex flex-row items-center">
                            <div class="flex-shrink pr-4">
                                <div class="rounded p-3 bg-slate-600"><Icon name="ri:kanban-view-2" class="text-white text-3xl" /></div>
                            </div>
                            <div class="flex-1 text-center md:text-center">
                                <h5 class="font-bold uppercase text-white">Recovered</h5>
                                <h3 class="font-bold text-3xl text-gray-600">{numOfRecovered}<span class="text-yellow-600"><!--<i class="fas fa-caret-up"></i>--></span></h3>
                            </div>
                        </div>
                    </div>
                    <!--/Metric Card-->
                </div>
                <div class="w-full md:w-1/4 p-3">
                    <!--Metric Card-->
                    <div class="bg-black border border-gray-600 rounded shadow p-2">
                        <div class="flex flex-row items-center">
                            <div class="flex-shrink pr-4">
                                <div class="rounded p-3 bg-slate-600"><Icon name="ri:flag-fill" class="text-white text-3xl" /></div>
                            </div>
                            <div class="flex-1 text-center md:text-center">
                                <h5 class="font-bold uppercase text-white">Surrendered</h5>
                                <h3 class="font-bold text-3xl text-gray-600">{numOfSurrendered}</h3>
                            </div>
                        </div>
                    </div>
                    <!--/Metric Card-->
                </div>
                
                
            </div>


			<!--Divider-->
			<div class="divider"></div>

	<!-- START: FBI Top Ten Content-->
			
			<div id="topten" class="flex flex-wrap">

		                <h3 class="font-bold uppercase text-2xl text-red-600">Top Ten</h3>
		                {
		
				       		fbiTTMWArray.map((fugitive:FbiType,index:number) => (
				       		
					       		
								<div class="w-full p-3">
							            <!--Fugitive Card-->
							            <div id={`fugitive-${index}`} class="bg-black rounded border-2 border-slate-200 shadow p-2 h-50 hover:bg-red-600" onclick={`window.open('${fugitive.url}')`}>
							                <div class="flex  items-center justify-center flex-col md:flex-row">
							               
							                    
														<div class="flex-shrink pr-4">
							                        <div class="rounded p-3">
							                        <a class="tooltip tooltip-bottom" data-tip="poster" href={fugitive.url} target="_blank" >
								                        <img class="w-16 md:w-32 lg:w-48" src={thumbImageUrls[index]} />
							                        </a>
							                        </div>
							                    </div>
							                    
							                    <div class="flex-1 text-center md:text-center">
															<div class="flex flex-col">
																<h5 class="text-right pb-3">
																	<button class="btn btn-square bg-white border-white ">
																		<a class="tooltip tooltip-bottom" data-tip="poster" href={fugitive.url} target="_blank">
																			<Icon name="ri:folder-info-fill" class="text-3xl text-red-600" />
																		</a>
																	</button>
																</h5>
																<h3 class="uppercase font-bold text-2xl text-red-500 bg-white">STATUS: [{fugitive.status == "na" ? "AT LIBERTY" : fugitive.status}]</h3>
								                    		<h5 class="font-bold uppercase text-red-500 bg-white">{fugitive.warning_message}</h5>							                    		
									                    	<h3 class="font-bold text-3xl text-white">S{fugitive.title}</h3>

								                        <h5 class="font-bold uppercase text-white">PUBLISHED:{fugitive.publication}</h5>
								                        <h5 class="uppercase text-white">{fugitive.description}</h5>
								                        
															</div>

							                   
								
							           
							                    </div>
							                </div>
							            </div>
							            <!--/Fugitive Card-->
							        </div>
								    ))
								}
				
		                
			</div>
<!-- END: FBI Top Ten Content-->
			
			<!--Divider-->
			<div class="divider"></div>
			
<!-- START: FBI In News Content-->
			<h3 class="font-bold uppercase text-2xl text-red-600">FBI In News [Posts: {fbiNewsArray.length}]</h3>

			<div id="fbinews" class="flex flex-wrap">


		                {
		
				       		fbiNewsArray.map((article:NewsDataInterface,index:number) => (
				       		
					       		
								<!--<div class="w-full p-3">-->
                                <div class="w-full md:w-1/2 xl:w-1/3 p-3">

							            <!--News Article Card-->
							            <div class="bg-black border-slate-200 rounded border-0 
							            shadow p-2 hover:bg-red-400/50 hover:shadow-red-400/50 h-52"  
							            onclick={`window.open('${article.link}')`}>

							                <div class="flex  items-center justify-center flex-col md:flex-row">
					
							                    <div class="flex-1 text-center md:text-center">
															<div class="flex flex-col">
																
									                     <h5 class="font-bold uppercase text-red-500" style={{ fontWeight: 200}}><a href={article.link} target="_blank">{article.date}</a></h5>
								                    		<h3 class="font-bold text-2xl text-white" style={{ fontWeight: 200}}><a href={article.link} target="_blank">{article.title.substring(0,100)}{article.title.length > 100 ? "..." : ""}</a></h3>


															</div>

							                   
								
							           
							                    </div>
							                </div>
							                
							            </div>
							            <!--/News Article Card-->
							        </div>
								    ))
								}
				
		                
			</div>
<!-- END: FBI In News Content-->


            </div>
								
			<!--/ Console Content-->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
  <div class="drawer-side mt-11">
    <label for="my-drawer-3" aria-label="close sidebar" class="drawer-overlay"></label>

    <ul class="menu bg-base-200 min-h-full w-80 p-4">
	    <details class="dropdown">
		 <summary class="btn text-lg">Section 1<Icon name="carbon:caret-down" class="pl-1"/></summary> 
		    <!-- Sidebar content here -->
		    <li><a>Sidebar Item 1</a></li>
		    <li><a>Sidebar Item 2</a></li>
	    </details>
	    
	    <details class="dropdown">
		 <summary class="btn text-lg">Section 2<Icon name="carbon:caret-down" class="pl-1"/></summary> 
		    <!-- Sidebar content here -->
		    <li><a>Sidebar Item 1</a></li>
		    <li><a>Sidebar Item 2</a></li>
	    </details>
	    
	    <details class="dropdown">
		 <summary class="btn text-lg">Section 3<Icon name="carbon:caret-down" class="pl-1"/></summary> 
		    <!-- Sidebar content here -->
		    <li><a>Sidebar Item 1</a></li>
		    <li><a>Sidebar Item 2</a></li>
	    </details>
    </ul>

  </div>
</div>









</main>
	</Layout>